  SELECT if(1=0,'Direct GRN','GRN From PO') GRNType,     lt.`LedgerTransactionNo` GRNNo,(SELECT SupplierName FROM st_vendormaster WHERE SupplierID=lt.vendorid) SupplierName, (select state from st_supplier_gstn where supplierid=lt.vendorid limit 1) SupplierState,  sl.location Location,   sm1.state  LocationState, sum(ROUND(snm.`Rate`*snm.InitialCount,2)) GrossAmount, sum(Round(snm.`DiscountAmount`*snm.InitialCount,2)) DiscountOnTotal,sum(ROUND(snm.`TaxAmount`*snm.InitialCount,2)) TaxAmount,sum(ROUND(snm.InitialCount*snm.UnitPrice,2)) NetAmount,lt.`InvoiceNo`,lt.`PurchaseOrderNo`   ,SUM(ROUND(((snm.`Rate`*snm.InitialCount)-snm.DiscountAmount)*IFNULL((SELECT percentage FROM st_taxchargedlist WHERE `stockid`=snm.stockid  AND taxname='IGST' LIMIT 1) ,'0')*0.01,2))TaxAmtIGST,  SUM(ROUND(((snm.`Rate`*snm.InitialCount)-snm.DiscountAmount)*IFNULL((SELECT percentage FROM st_taxchargedlist WHERE `stockid`=snm.stockid   AND taxname='CGST' LIMIT 1) ,'0')*0.01,2)) TaxAmtCGST,  SUM(ROUND(((snm.`Rate`*snm.InitialCount)-snm.DiscountAmount)*IFNULL((SELECT percentage FROM st_taxchargedlist WHERE `stockid`=snm.stockid   AND taxname='SGST' LIMIT 1) ,'0')*0.01,2)) TaxAmtSGST   ,DATE_FORMAT(lt.`DateTime`,'%d-%b-%Y')GRNDate,(SELECT NAME FROM employee_master WHERE employee_id=lt.Creator_UserID)GRNBYUser,IF(lt.`IsPODGenerate`=1,lt.`PODnumber`,'') PODnumber  , (CASE  IFNULL(spd.`Is_payment`,'') WHEN 1 THEN 'Yes' WHEN '' THEN '' ELSE 'No' END ) 'Is Payment'   , (CASE  IFNULL(spd.`Is_forwarded`,'') WHEN 1 THEN 'Yes' WHEN '' THEN '' ELSE 'No' END ) 'Is Forwarded'   , (CASE  IFNULL(spd.`IsPOD_Accept`,'') WHEN 1 THEN 'Yes' WHEN '' THEN '' ELSE 'No' END ) 'Is POD Accept'   , (CASE  IFNULL(spd.`IsPOD_transfer`,'') WHEN 1 THEN 'Yes' WHEN '' THEN '' ELSE 'No' END ) 'Is POD Transfer'   , snm.ItemId   FROM `st_ledgertransaction` lt   left join st_pod_details spd on spd.podnumber=lt.PODnumber  inner join st_locationmaster sl on sl.locationid=lt.locationid  inner join state_master sm1 on   sm1.id=sl.StateID   INNER JOIN st_nmstock snm ON lt.`LedgerTransactionID`=snm.`LedgerTransactionID`    WHERE lt.`IsCancel`=0 AND  typeoftnx='Purchase' AND ifnull(vendorid,0)<>0    AND lt.`DateTime`>='2022-04-10 00:00:00'   AND lt.`DateTime`<='2022-04-13 23:59:59'   and IsDirectGRN=0 group by lt.`LedgerTransactionID` ORDER BY lt.locationid, lt.`LedgerTransactionID`  