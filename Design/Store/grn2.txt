  SELECT if(1= 1,'Direct GRN','GRN From PO') GRNType,     lt.`LedgerTransactionNo` GRNNo,vm.SupplierName , (select state from st_supplier_gstn where supplierid=lt.vendorid limit 1) SupplierState,  sl.location Location,    sm12.state  LocationState,  lt.`InvoiceNo`,lt.`PurchaseOrderNo`,     ssm1.CategoryTypeName CategoryType, sm1.SubCategoryTypeName SubCategoryType,ssm.Name ItemType,   itg.`ItemNameGroup` `ItemName`,    sm.`ManufactureName`,sm.`MachineName`,sm.`PackSize`,sm.catalogno,sm.hsncode,   snm.`BarcodeNo`,if(snm.IsBarcodePrinted='1','Yes','No')IsBarcodePrinted,snm.batchnumber,DATE_FORMAT(snm.`ExpiryDate`,'%d-%b-%Y') ExpiryDate,    (snm.`InitialCount`/snm.converter) GRNQty,snm.`Rate` as 'Gross Total(Rate)',snm.DiscountPer,snm.`DiscountAmount` DiscountAmount,snm.TaxPer,snm.`TaxAmount` TaxAmount,    ((snm.rate-snm.DiscountAmount)*IFNULL((SELECT percentage FROM st_taxchargedlist WHERE `stockid`=snm.stockid  AND taxname='IGST' LIMIT 1) ,'0')*0.01)TaxAmtIGST, ((snm.rate-snm.DiscountAmount)*IFNULL((SELECT percentage FROM st_taxchargedlist WHERE `stockid`=snm.stockid   AND taxname='CGST' LIMIT 1) ,'0')*0.01) TaxAmtCGST, ((snm.rate-snm.DiscountAmount)*IFNULL((SELECT percentage FROM st_taxchargedlist WHERE `stockid`=snm.stockid   AND taxname='SGST' LIMIT 1) ,'0')*0.01) TaxAmtSGST, snm.`UnitPrice` as 'Net Total(UnitPrice)',InitialCount*UnitPrice Stockvalue, if(snm.`IsFree`=1,'Yes','')IsFree,  snm.`IsPost`,DATE_FORMAT(lt.`DateTime`,'%d-%b-%Y')GRNDate,DATE_FORMAT(lt.`DateTime`,'%b-%Y')GRNMonth,(SELECT NAME FROM employee_master WHERE employee_id=lt.Creator_UserID)GRNBYUser,    DATE_FORMAT(snm.`PostDate`,'%d-%b-%Y') PostDate,(SELECT NAME FROM employee_master WHERE employee_id=snm.`PostUserID`)PostByUeser,IF(lt.`IsPODGenerate`=1,lt.`PODnumber`,'') PODnumber    , (CASE  IFNULL(spd.`Is_payment`,'') WHEN 1 THEN 'Yes' WHEN '' THEN '' ELSE 'No' END ) 'Is Payment'   , (CASE  IFNULL(spd.`Is_forwarded`,'') WHEN 1 THEN 'Yes' WHEN '' THEN '' ELSE 'No' END ) 'Is Forwarded'   , (CASE  IFNULL(spd.`IsPOD_Accept`,'') WHEN 1 THEN 'Yes' WHEN '' THEN '' ELSE 'No' END ) 'Is POD Accept'   , (CASE  IFNULL(spd.`IsPOD_transfer`,'') WHEN 1 THEN 'Yes' WHEN '' THEN '' ELSE 'No' END ) 'Is POD Transfer'   , snm.ItemId   FROM `st_ledgertransaction` lt   left join st_pod_details spd on spd.podnumber=lt.PODnumber   INNER JOIN st_nmstock snm ON lt.`LedgerTransactionID`=snm.`LedgerTransactionID`     INNER JOIN st_itemmaster sm ON sm.`ItemID`=snm.`ItemID`    INNER JOIN `st_itemmaster_group` itg ON itg.`ItemIDGroup`=sm.`ItemIDGroup`    INNER JOIN `st_categorytypemaster` ssm1 ON ssm1.CategoryTypeID=sm.CategoryTypeID     INNER JOIN `st_subcategorymaster` ssm ON ssm.SubCategoryID=sm.SubCategoryID     INNER JOIN `st_subcategorytypemaster` sm1 ON sm1.SubCategoryTypeID=sm.SubCategoryTypeID   inner join st_locationmaster sl on sl.locationid=lt.locationid and sl.locationid in (22)  inner join state_master sm12 on   sm12.id=sl.StateID   left join st_vendormaster vm on vm.SupplierID=lt.vendorid   WHERE lt.`IsCancel`=0 AND  typeoftnx='Purchase' AND vendorid<>0    AND lt.`DateTime`>='2022-04-01 00:00:00'   AND lt.`DateTime`<='2022-04-13 23:59:59'   and IsDirectGRN=1 ORDER BY lt.locationid, lt.`LedgerTransactionID`,snm.`ItemName`  