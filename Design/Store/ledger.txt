 select cat.CategoryTypeName,subcat.SubCategoryTypeName,itemcat.Name itemTypeName,  im.typename ItemName , im.`ManufactureName`,im.`MachineName`,im.`PackSize`, im.`CatalogNo`,im.`HsnCode`,  temp5.ItemID,sum(OpenQty) OpenQty,SUM(OpenAmt)OpenAmt, SUM(PurQty) PurchaseQty,SUM(PurAmt)PurchaseAmt,  SUM(DeptRetQty)IssueReturnQty,SUM(DeptRetAmt) IssueReturnAmt,sum(VenReplacementQty)VenReplacementQty, sum(VenReplacementAmt)VenReplacementAmt,sum(GatherpQty)GatherQty,sum(GatherAmt)GatherAmt,sum(DeptRecQty)LocationReceiveQty,sum(DeptRecAmt)LocationReceiveAmt,SUM(AdjAdQty)`AdjustmentQty(+)`,SUM(AdjAddAmt)`AdjustmentAmt(+)`, SUM(DeptSoldQty)IssueQty,SUM(DeptSelAmt)IssueAmt,sum(ConsumeQty)ConsumeQty,sum(ConsumeAmt)ConsumeAmt,sum(AutoConsumeQty) AutoConsumeQty,sum(AutoConsumeAmt) AutoConsumeAmt,SUM(AdjustSubTQty)`ProcessQty(-)`,SUM(AdjustSubTAmt)`ProcessAmt(-)`, SUM(VenRetQty)VendorReturnQty,SUM(VenRetAmt)VendorReturnAmt,  ROUND((-SUM(IFNULL(PurQty,0)+IFNULL(OpenQty,0)+IFNULL(DeptRecQty,0)+IFNULL(AdjAdQty,0)+IFNULL(PtRtnQty,0)+IFNULL(DeptRetQty,0)+IFNULL(GatherpQty,0)+IFNULL(VenReplacementQty,0))+SUM(IFNULL(DeptSoldQty,0)+IFNULL(VenRetQty,0)+IFNULL(ConsumeQty,0)+IFNULL(AdjustSubTQty,0)+IFNULL(PetsoldQty,0))),1)ClosingQty ,  ROUND((-SUM(IFNULL(PurAmt,0)+IFNULL(OpenAmt,0)+IFNULL(DeptRecAmt,0)+IFNULL(AdjAddAmt,0)+IFNULL(PtRtnAmt,0)+IFNULL(DeptRetAmt,0)+IFNULL(GatherAmt,0)+IFNULL(VenReplacementAmt,0))+SUM(IFNULL(DeptSelAmt,0)+IFNULL(VenRetAmt,0)+IFNULL(ConsumeAmt,0)+IFNULL(AdjustSubTAmt,0)+IFNULL(PetsoldAmt,0))),1)ClosingAmt   From (              Select LocationID,StockID,ItemID,(sum(InitialCount)+sum(RtnQty)-sum(SellQty))OpenQty,(sum(InitAmt)+sum(RtnAmt)-sum(SellAmt))OpenAmt,              0 AS PurQty,0 DeptRecQty,0 AS PtRtnQty,0 AS AdjAdQty,0 AS PurAmt,0 DeptRecAmt,0 AS PtRtnAmt,0 AS AdjAddAmt, 0 As DeptSoldQty,0 As DeptRetQty,              0 As PetSoldQty,0 As VenRetQty,0 As AdjustSubTQty, 0 As DeptSelAmt,0 As DeptRetAmt,0 As VenRetAmt, 0 As AdjustSubTAmt,              0 As PetsoldAmt, 0 ConsumeQty,0 AutoConsumeQty, 0 GatherpQty, 0 ConsumeAmt,0 AutoConsumeAmt, 0 GatherAmt, 0 VenReplacementQty, 0 VenReplacementAmt   FROM (                  Select LocationID,StockID,ItemID,InitialCount,(InitialCount*UnitPrice)As InitAmt, 0 As RtnQty,0 As SellQty,0 AS RtnAmt,                  0 As SellAmt FROM st_nmstock WHERE PostDate < '2022-04-01 00:00:00'  And IsPost = 1                  Union All                   Select sd.fromLocationID LocationID,sd.StockID,st.ItemID,0 As InitialCount,0 As InitAmt,                   IFNULL((Case When sd.TrasactionTypeID in(7) Then sd.`Quantity` End),0) As RtnQty,                   IFNULL((Case When sd.TrasactionTypeID in(1,2,3,4,5,6) Then sd.`Quantity` End),0) As SellQty,                   IFNULL((Case When sd.TrasactionTypeID in(7) Then sd.`Quantity`*st.`UnitPrice` End),0) As RtnAmt,                   IFNULL((Case When sd.TrasactionTypeID in(1,2,3,4,5,6) Then sd.`Quantity`*st.`UnitPrice` End),0) As SellAmt                   FROM st_nmsalesdetails sd                    INNER JOIN `st_nmstock` st ON st.`StockID`=sd.`StockID`                    WHERE sd.TrasactionTypeID IN(1,2,3,4,5,6)                   And sd.DateTime < '2022-04-01 00:00:00'    and sd.fromLocationID in ('1','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26')               )temp1 group by ItemID               Union All               Select LocationID,StockID,ItemID,0 AS OpenQty,0 as OpenAmt,sum(PurchaseQty)PurQty,sum(DeptRecQty)DeptRecQty,sum(PetRtnQty)PtRtnQty,               sum(AdjustAddQty)AdjAdQty,sum(PurchaseAmt)PurAmt,sum(DeptRecAmt)DeptRecAmt,sum(PetRtnAmt)PtRtnAmt,sum(AdjustAddAmt)AdjAddAmt,               0 As DeptSoldQty, 0 As DeptRetQty,0 As PetSoldQty,0 As VenRetQty,0 As AdjustSubTQty,0 As DeptSelAmt,               0 As DeptRetAmt, 0 As VenRetAmt,0 As AdjustSubTAmt,0 As PetsoldAmt, 	         0 ConsumeQty,0 AutoConsumeQty, 0 GatherpQty, 0 ConsumeAmt,0 AutoConsumeAmt, 0 GatherAmt,sum(VendorReplacementAddQty) VenReplacementQty, sum(VendorReplacementAddAmt) VenReplacementAmt From (                   SELECT st.LocationID, st.StockID, st.ItemID, st.UnitPrice,                   if(ifnull(lt.Typeoftnx,'')='Purchase', st.InitialCount,0) PurchaseQty,                    if(ifnull(lt.Typeoftnx,'')='Purchase', st.InitialCount*st.UnitPrice ,0) PurchaseAmt,                   if(st.fromstockID<>0,st.InitialCount,0) and lt.Typeoftnx != 'VendorReplacement' AS DeptRecQty,                   0 AS PetRtnQty,                   if(ifnull(lt.Typeoftnx,'')='StockAdjustment', st.InitialCount,0) AS AdjustAddQty,                   if(st.fromstockID<>0,st.InitialCount*st.UnitPrice,0) AS DeptRecAmt,                   0 AS PetRtnAmt,                   if(ifnull(lt.Typeoftnx,'')='StockAdjustment', st.InitialCount*st.UnitPrice ,0) AS AdjustAddAmt,                   if(ifnull(lt.Typeoftnx,'')='VendorReplacement', st.InitialCount,0) AS VendorReplacementAddQty,                   if(ifnull(lt.Typeoftnx,'')='VendorReplacement', st.InitialCount*st.UnitPrice ,0) AS VendorReplacementAddAmt                   FROM st_nmstock st LEFT join st_ledgertransaction lt on lt.LedgerTransactionID = st.LedgerTransactionID                  WHERE st.IsPost = 1  And st.PostDate >= '2022-04-01 00:00:00'                   And st.PostDate <= '2022-04-30 23:59:59'     and st.LocationID in ('1','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26')               )Temp1 group by ItemID               union All               SELECT LocationID,StockID,ItemID,0 As OpenQty,0 As OpenAmt,sum(VenRecpQty) AS PurQty,0 DeptRecQty,sum(RetPetQty) AS PtRtnQty,0 AS AdjAdQty,               sum(VenRecpAmt) AS PurAmt,0 DeptRecAmt, sum(RetPetAmt) AS PtRtnAmt,0 AS AdjAddAmt,SUM(OutDeptQty)DeptSoldQty,SUM(RetDeptQty)DeptRetQty,               SUM(OutPetQty)PetSoldQty, SUM(RetVenQty)VenRetQty,SUM(AdjustQty)AdjustSubTQty,SUM(OutDeptAmt)DeptSelAmt,               SUM(RetDeptAmt)DeptRetAmt,SUM(RetVenAmt)VenRetAmt, SUM(AdjAmt)AdjustSubTAmt,SUM(OutPetAmt)PetsoldAmt,  	         sum(ConsumeQty)ConsumeQty,sum(AutoConsumeQty) AutoConsumeQty,sum(GatherpQty)GatherpQty,sum(ConsumeAmt)ConsumeAmt,sum(AutoConsumeAmt) AutoConsumeAmt,sum(GatherAmt)GatherAmt, 0 VenReplacementQty, 0 VenReplacementAmt  FROM (                   SELECT LocationID, StockID,ItemID,(CASE WHEN TrasactionTypeID = 2 Then Qty else 0 END)AS OutDeptQty,                   IFNULL((CASE WHEN TrasactionTypeID = 6 Then Qty  else 0 END),0) AS RetDeptQty,                   0 AS OutPetQty,                   0 AS RetPetQty,                   IFNULL((CASE WHEN TrasactionTypeID = 4 Then Qty  else 0 END),0) AS RetVenQty,                   IFNULL((CASE WHEN TrasactionTypeID = 3 Then Qty  else 0 END),0) AS AdjustQty,                   IFNULL((CASE WHEN TrasactionTypeID = 12 Then Qty  else 0 END),0) AS VenRecpQty,     		         IFNULL((CASE WHEN TrasactionTypeID = 1  Then Qty  else 0 END),0) AS ConsumeQty,      		         IFNULL((CASE WHEN TrasactionTypeID = 5  Then Qty  else 0 END),0) AS AutoConsumeQty,           	     IFNULL((CASE WHEN TrasactionTypeID = 14 Then Qty  else 0 END),0) AS GatherpQty,                    IFNULL((CASE WHEN TrasactionTypeID = 2 Then Qty*PerUnitBuyPrice  else 0 END),0) AS OutDeptAmt,                   IFNULL((CASE WHEN TrasactionTypeID = 6 Then Qty*PerUnitBuyPrice  else 0 END),0) AS RetDeptAmt,                   0 AS OutPetAmt,                   0 AS RetPetAmt,                   IFNULL((CASE WHEN TrasactionTypeID = 4 Then Qty*PerUnitBuyPrice  else 0 END),0) AS RetVenAmt,                   IFNULL((CASE WHEN TrasactionTypeID = 12 Then Qty*PerUnitBuyPrice  else 0 END),0) AS VenRecpAmt,                   IFNULL((CASE WHEN TrasactionTypeID = 3 Then Qty*PerUnitBuyPrice  else 0 END),0) AS AdjAmt,          		 IFNULL((CASE WHEN TrasactionTypeID = 1  Then Qty*PerUnitBuyPrice  else 0 END),2) AS ConsumeAmt,           		 IFNULL((CASE WHEN TrasactionTypeID = 5  Then Qty*PerUnitBuyPrice  else 0 END),0) AS AutoConsumeAmt,           		 IFNULL((CASE WHEN TrasactionTypeID = 14 Then Qty*PerUnitBuyPrice  else 0 END),0) AS GatherAmt  			     FROM (           	        SELECT sd.FromLocationID LocationID, sd.StockID,st.ItemID,SUM(sd.`Quantity`)AS Qty,sd.TrasactionTypeID,st.UnitPrice PerUnitBuyPrice,'' IsService                      FROM st_nmsalesdetails sd                       INNER JOIN `st_nmstock` st ON st.`StockID`=sd.`StockID`                       WHERE sd.DateTime >= '2022-04-01 00:00:00' And sd.DateTime <= '2022-04-30 23:59:59'           	        AND sd.TrasactionTypeID IN(1,2,3,4,5,6)           	        GROUP BY sd.StockID,st.ItemID,sd.TrasactionTypeID                   )temp1  GROUP BY StockID,ItemID,TrasactionTypeID               )temp2  GROUP BY ItemID           ) Temp5              inner join st_itemmaster IM on Temp5.ItemID  = IM.ItemID   and IM.itemid in ( 2356 , 1384 , 2596 , 2355 , 1713 , 1714 , 2140 , 2169 , 1845 , 1846 , 1166 , 1559 , 2060 , 2061 , 1433 , 468 , 2794 , 356 , 1434 , 1435 , 1436 , 782 , 783 , 1437 , 357 , 1847 , 1438 , 1848 , 1849 , 2186 , 2187 , 2188 , 2189 , 2190 , 2191 , 469 , 2192 , 784 , 785 , 786 , 787 , 788 , 789 , 790 , 791 , 792 , 2742 , 940 , 1439 , 1440 , 1441 , 358 , 941 , 470 , 1044 , 942 , 793 , 1100 , 2807 , 2795 , 2739 , 1442 , 794 , 2354 , 2 , 795 , 796 , 797 , 2258 , 2766 , 1850 , 1045 , 1046 , 1560 , 1561 , 473 , 1167 , 2259 , 1562 , 2357 , 2358 , 2359 , 2360 , 2361 , 474 , 1852 , 943 , 2062 , 2063 , 475 , 2064 , 1168 , 1563 , 1564 , 476 , 336 , 1853 , 1854 , 359 , 1565 , 1566 , 1567 , 477 , 1169 , 1170 , 1351 , 1171 , 1172 , 1173 , 1199 , 1101 , 1174 , 407 , 1102 , 1175 , 1176 , 1177 , 1178 , 1103 , 1179 , 798 , 799 , 800 , 1180 , 1181 , 1182 , 1183 , 1184 , 1185 , 1186 , 1187 , 1188 , 1189 , 1190 , 1191 , 1192 , 1193 , 1194 , 1195 , 1163 , 1196 , 1197 , 1198 , 801 , 1200 , 1104 , 1201 , 1202 , 1203 , 408 , 1105 , 2788 , 1569 , 1443 , 1855 , 1856 , 1857 , 1444 , 1445 , 6 , 7 , 2783 , 802 , 478 , 2805 , 2362 , 2363 , 2364 , 2365 , 2366 , 2806 , 1204 , 1205 , 1206 , 1207 , 1208 , 1209 , 1210 , 2368 , 2369 , 1211 , 2371 , 2372 , 2373 , 2374 , 2376 , 2375 , 2377 , 2378 , 2379 , 2380 , 2381 , 2382 , 2383 , 2384 , 2385 , 2386 , 2387 , 2388 , 2389 , 2390 , 2391 , 2392 , 1212 , 1213 , 1214 , 1215 , 1216 , 1217 , 1219 , 1220 , 1221 , 1222 , 1225 , 1226 , 1227 , 1228 , 1229 , 1230 , 2394 , 2395 , 2396 , 1232 , 1234 , 1235 , 8 , 10 , 9 , 11 , 12 , 13 , 2397 , 2398 , 2399 , 2400 , 2401 , 2402 , 2403 , 2404 , 2405 , 2406 , 14 , 15 , 1237 , 1238 , 1239 , 2407 , 2408 , 2409 , 2410 , 1240 , 2411 , 1570 , 1571 , 1572 , 1241 , 1242 , 1243 , 2412 , 2752 , 2413 , 2414 , 2415 , 2416 , 1245 , 2417 , 2418 , 16 , 17 , 2421 , 2422 , 1246 , 1223 , 479 , 2703 , 2747 , 2772 , 19 , 335 , 1446 , 1447 , 2065 , 1531 , 2507 , 2425 , 20 , 21 , 22 , 23 , 24 , 77 , 25 , 26 , 27 , 28 , 29 , 30 , 31 , 32 , 33 , 34 , 35 , 36 , 37 , 38 , 39 , 40 , 41 , 42 , 43 , 44 , 45 , 46 , 47 , 48 , 49 , 50 , 51 , 52 , 2768 , 53 , 54 , 55 , 56 , 57 , 58 , 59 , 60 , 61 , 62 , 63 , 64 , 65 , 66 , 67 , 68 , 69 , 70 , 71 , 72 , 73 , 74 , 75 , 76 , 78 , 2426 , 2427 , 2428 , 2429 , 2430 , 2431 , 2432 , 2433 , 2434 , 2435 , 2436 , 2437 , 2438 , 2439 , 2440 , 2441 , 2442 , 2424 , 2444 , 2445 , 2446 , 2447 , 2448 , 2449 , 2450 , 2451 , 2452 , 2453 , 2454 , 2455 , 2456 , 2458 , 2459 , 2460 , 2461 , 2462 , 2463 , 2464 , 2466 , 2467 , 2468 , 2469 , 2470 , 2471 , 2472 , 2473 , 2474 , 2475 , 2476 , 2477 , 2478 , 2479 , 2706 , 2480 , 2481 , 2482 , 2484 , 2485 , 2486 , 2487 , 2488 , 2489 , 2490 , 2491 , 2492 , 2494 , 2495 , 2496 , 2497 , 2498 , 2499 , 2501 , 2500 , 2502 , 2503 , 79 , 80 , 2483 , 81 , 2505 , 2506 , 2508 , 2066 , 2640 , 2778 , 2801 , 2510 , 2511 , 2759 , 2512 , 1248 , 2513 , 2817 , 1249 , 1250 , 2726 , 2514 , 2515 , 1251 , 2744 , 1252 , 2516 , 2517 , 2518 , 2519 , 2353 , 1573 , 480 , 481 , 482 , 1574 , 1575 , 1576 , 944 , 1577 , 1584 , 483 , 484 , 485 , 487 , 1996 , 1997 , 1586 , 1587 , 337 , 945 , 1588 , 409 , 410 , 411 , 412 , 413 , 414 , 415 , 416 , 417 , 1589 , 1590 , 946 , 947 , 948 , 2067 , 2068 , 2069 , 949 , 418 , 492 , 950 , 2812 , 493 , 494 , 1106 , 1107 , 338 , 1254 , 2072 , 2073 , 2074 , 2075 , 2076 , 495 , 2740 , 1858 , 1998 , 1591 , 82 , 83 , 84 , 85 , 86 , 87 , 88 , 89 , 90 , 91 , 92 , 93 , 94 , 95 , 96 , 97 , 98 , 99 , 100 , 101 , 102 , 103 , 104 , 105 , 106 , 107 , 108 , 109 , 110 , 111 , 112 , 18 , 113 , 114 , 115 , 116 , 119 , 117 , 118 , 120 , 121 , 122 , 123 , 124 , 125 , 126 , 127 , 128 , 129 , 2815 , 130 , 131 , 132 , 133 , 134 , 135 , 136 , 137 , 138 , 139 , 140 , 141 , 142 , 2784 , 143 , 144 , 145 , 146 , 147 , 148 , 149 , 150 , 151 , 152 , 153 , 154 , 155 , 156 , 157 , 158 , 159 , 160 , 161 , 162 , 163 , 164 , 165 , 166 , 167 , 168 , 169 , 170 , 171 , 172 , 173 , 175 , 176 , 177 , 178 , 179 , 180 , 181 , 182 , 183 , 184 , 185 , 186 , 187 , 188 , 189 , 190 , 191 , 192 , 193 , 194 , 195 , 196 , 197 , 198 , 199 , 201 , 202 , 203 , 204 , 205 , 200 , 206 , 207 , 174 , 208 , 209 , 1532 , 2193 , 951 , 1592 , 498 , 501 , 502 , 503 , 1999 , 504 , 505 , 506 , 507 , 508 , 509 , 510 , 511 , 512 , 513 , 803 , 2194 , 360 , 2195 , 2196 , 1260 , 1257 , 1256 , 1258 , 1259 , 1859 , 804 , 1593 , 1594 , 1595 , 1596 , 2261 , 2000 , 1860 , 2728 , 2729 , 1108 , 1109 , 1597 , 210 , 211 , 2197 , 212 , 805 , 1110 , 1598 , 1448 , 514 , 1599 , 1600 , 1111 , 2078 , 2079 , 2080 , 952 , 1449 , 1450 , 2001 , 2002 , 2003 , 2081 , 1112 , 1113 , 1114 , 1115 , 1116 , 1117 , 1118 , 1119 , 419 , 1120 , 2082 , 420 , 1121 , 953 , 954 , 1122 , 1123 , 421 , 422 , 1124 , 423 , 424 , 425 , 426 , 427 , 428 , 429 , 430 , 431 , 432 , 1125 , 433 , 434 , 435 , 1126 , 436 , 437 , 438 , 439 , 440 , 441 , 442 , 443 , 444 , 445 , 446 , 447 , 448 , 449 , 1127 , 1601 , 1602 , 1603 , 1604 , 1605 , 1606 , 1607 , 1608 , 1609 , 1611 , 1612 , 1613 , 1614 , 1615 , 1616 , 1617 , 1618 , 1619 , 1620 , 1621 , 515 , 806 , 807 , 516 , 808 , 2198 , 2199 , 2200 , 2520 , 2521 , 2522 , 2523 , 2524 , 2525 , 2526 , 2527 , 2528 , 2530 , 2532 , 2533 , 2534 , 2535 , 2536 , 2537 , 2538 , 2539 , 2542 , 2544 , 2545 , 2547 , 2548 , 2550 , 2551 , 2552 , 2553 , 2554 , 2555 , 2557 , 2558 , 2559 , 2560 , 213 , 2561 , 2562 , 2563 , 2564 , 2565 , 2566 , 2567 , 2568 , 2569 , 2570 , 2571 , 2572 , 2573 , 2574 , 2575 , 2576 , 2577 , 2578 , 2579 , 2580 , 2581 , 2582 , 2583 , 2584 , 2586 , 2587 , 2588 , 2590 , 2591 , 2592 , 2593 , 214 , 1861 , 1622 , 1623 , 1624 , 2704 , 215 , 809 , 1862 , 1863 , 955 , 1625 , 956 , 1628 , 361 , 1263 , 1264 , 1265 , 1266 , 1267 , 1268 , 1269 , 1270 , 2595 , 1271 , 1272 , 1274 , 2735 , 1128 , 1629 , 1630 , 1451 , 216 , 1631 , 217 , 1632 , 1634 , 1047 , 2181 , 2182 , 1275 , 810 , 1635 , 2771 , 2201 , 2202 , 2083 , 362 , 363 , 518 , 2203 , 519 , 1452 , 1453 , 2004 , 2005 , 520 , 1864 , 218 , 219 , 812 , 220 , 2796 , 2797 , 2204 , 2006 , 2084 , 339 , 1640 , 521 , 2786 , 957 , 364 , 365 , 526 , 527 , 958 , 959 , 960 , 340 , 450 , 366 , 1276 , 1277 , 1865 , 1866 , 1278 , 1279 , 2085 , 1280 , 813 , 814 , 221 , 222 , 528 , 341 , 451 , 452 , 1129 , 453 , 1130 , 1131 , 1132 , 1133 , 1134 , 1135 , 2007 , 961 , 962 , 815 , 816 , 817 , 818 , 2008 , 1454 , 1455 , 1456 , 1457 , 1458 , 1459 , 820 , 2009 , 367 , 2205 , 1460 , 1461 , 1462 , 1463 , 1464 , 1281 , 1282 , 2792 , 1283 , 1287 , 1284 , 1285 , 1286 , 963 , 2086 , 223 , 529 , 1867 , 2010 , 2011 , 2012 , 2013 , 2014 , 1465 , 1136 , 2707 , 2708 , 1288 , 533 , 964 , 534 , 1289 , 1290 , 965 , 224 , 535 , 2015 , 2257 , 225 , 2741 , 226 , 2016 , 1050 , 1051 , 536 , 537 , 538 , 966 , 544 , 546 , 1533 , 547 , 548 , 1868 , 1052 , 1641 , 2087 , 2206 , 1642 , 967 , 549 , 550 , 551 , 1643 , 1291 , 2208 , 2207 , 1644 , 1053 , 1054 , 1055 , 1056 , 552 , 1057 , 227 , 553 , 1137 , 1138 , 822 , 823 , 824 , 1648 , 1645 , 1646 , 1647 , 1649 , 1869 , 968 , 228 , 229 , 2088 , 2089 , 2090 , 554 , 1292 , 969 , 1990 , 1870 , 1650 , 1534 , 970 , 971 , 2091 , 2092 , 1991 , 2719 , 342 , 555 , 1294 , 1652 , 1295 , 972 , 973 , 1139 , 1871 , 556 , 2209 , 826 , 827 , 828 , 829 , 830 , 831 , 832 , 833 , 834 , 835 , 836 , 838 , 839 , 840 , 841 , 842 , 843 , 844 , 1653 , 845 , 1654 , 1296 , 1655 , 846 , 847 , 557 , 848 , 974 , 558 , 559 , 1872 , 975 , 1873 , 1874 , 560 , 1535 , 1875 , 561 , 849 , 976 , 1876 , 1877 , 1878 , 562 , 1656 , 2017 , 2262 , 1058 , 1466 , 2210 , 850 , 851 , 852 , 563 , 853 , 977 , 978 , 564 , 2814 , 565 , 1879 , 1880 , 566 , 567 , 2597 , 568 , 980 , 1467 , 1297 , 1298 , 1299 , 1300 , 1301 , 854 , 368 , 1881 , 569 , 1658 , 1302 , 1659 , 855 , 454 , 2263 , 2264 , 1303 , 570 , 2018 , 2019 , 2020 , 2021 , 981 , 982 , 1536 , 1660 , 343 , 1304 , 571 , 2093 , 2094 , 2095 , 2096 , 1661 , 1882 , 1883 , 1537 , 856 , 857 , 858 , 859 , 860 , 861 , 230 , 231 , 862 , 863 , 864 , 865 , 1062 , 1064 , 1065 , 1060 , 1066 , 1067 , 1061 , 1059 , 1063 , 1662 , 1140 , 572 , 573 , 574 , 575 , 576 , 577 , 1663 , 1884 , 1885 , 1886 , 1887 , 578 , 232 , 1888 , 1664 , 579 , 983 , 580 , 581 , 1068 , 2767 , 582 , 369 , 583 , 1141 , 2211 , 587 , 588 , 2212 , 589 , 590 , 1468 , 985 , 1666 , 1667 , 591 , 2213 , 592 , 2723 , 2724 , 2725 , 2722 , 2721 , 2720 , 866 , 867 , 345 , 2266 , 593 , 873 , 233 , 594 , 595 , 1069 , 1469 , 1470 , 1471 , 1472 , 1071 , 1072 , 1073 , 1305 , 868 , 869 , 871 , 1306 , 1889 , 1890 , 1074 , 597 , 1891 , 1892 , 1308 , 1473 , 2267 , 598 , 872 , 986 , 875 , 876 , 877 , 878 , 879 , 880 , 881 , 882 , 883 , 884 , 2799 , 885 , 886 , 887 , 888 , 889 , 890 , 891 , 892 , 893 , 894 , 346 , 1668 , 1311 , 1312 , 1313 , 1142 , 987 , 1671 , 1669 , 1670 , 599 , 1672 , 1673 , 988 , 1893 , 2214 , 895 , 989 , 1075 , 600 , 1314 , 1894 , 2022 , 2023 , 1164 , 1315 , 1895 , 455 , 990 , 370 , 601 , 1475 , 1476 , 1477 , 1478 , 1479 , 1480 , 1474 , 1481 , 1482 , 1483 , 1484 , 1485 , 1486 , 1538 , 1316 , 1317 , 1318 , 1319 , 1320 , 2749 , 2764 , 2750 , 2787 , 2751 , 1321 , 456 , 457 , 458 , 1322 , 991 , 602 , 1674 , 1896 , 1897 , 603 , 2215 , 1898 , 371 , 1899 , 2730 , 2711 , 2818 , 2712 , 234 , 235 , 1675 , 2598 , 2599 , 896 , 372 , 373 , 374 , 1323 , 1324 , 1325 , 236 , 2600 , 2601 , 2602 , 2603 , 2604 , 2605 , 2606 , 2607 , 2608 , 2609 , 237 , 2610 , 2611 , 2612 , 2613 , 2614 , 2615 , 2616 , 2617 , 2618 , 2619 , 2620 , 2621 , 2622 , 2623 , 2624 , 2625 , 2626 , 2627 , 2628 , 2629 , 2630 , 2631 , 2633 , 2634 , 2635 , 2636 , 2637 , 2638 , 2639 , 238 , 1326 , 239 , 1165 , 1327 , 1328 , 1329 , 1331 , 1332 , 1333 , 1334 , 1335 , 1336 , 1337 , 1338 , 1339 , 1340 , 1341 , 1342 , 1343 , 1344 , 1345 , 1346 , 1900 , 2216 , 604 , 2100 , 1347 , 992 , 1348 , 1539 , 993 , 605 , 1901 , 1487 , 2101 , 2102 , 1906 , 1903 , 1902 , 1904 , 1907 , 1905 , 1908 , 1909 , 1910 , 1911 , 1912 , 1913 , 1914 , 994 , 995 , 997 , 996 , 1143 , 240 , 241 , 242 , 606 , 1488 , 1144 , 2268 , 2269 , 607 , 1915 , 608 , 1677 , 1678 , 1679 , 2217 , 2104 , 2105 , 243 , 2106 , 1680 , 1145 , 244 , 2218 , 609 , 2225 , 1489 , 1490 , 1491 , 610 , 611 , 2024 , 613 , 1492 , 1681 , 1682 , 2025 , 1683 , 897 , 245 , 1349 , 1350 , 2026 , 2027 , 1685 , 614 , 615 , 2642 , 2643 , 246 , 2644 , 1352 , 247 , 1353 , 1354 , 248 , 249 , 2645 , 2646 , 2647 , 2648 , 1355 , 1356 , 1357 , 1358 , 1359 , 1360 , 1361 , 1362 , 1363 , 1364 , 1365 , 1366 , 250 , 1367 , 1368 , 1369 , 1370 , 2649 , 1371 , 2758 , 616 , 2650 , 1372 , 1373 , 617 , 1374 , 1375 , 1376 , 618 , 1377 , 1378 , 1379 , 1380 , 1381 , 1382 , 251 , 2651 , 2652 , 1493 , 1689 , 2731 , 898 , 899 , 252 , 253 , 347 , 254 , 1076 , 1690 , 2107 , 2108 , 2109 , 620 , 1494 , 1495 , 998 , 1916 , 1992 , 2705 , 348 , 375 , 255 , 256 , 900 , 2653 , 2654 , 2655 , 901 , 1691 , 376 , 1693 , 1694 , 1697 , 2656 , 2657 , 2658 , 2659 , 2660 , 2661 , 2662 , 2663 , 2664 , 2665 , 2666 , 2667 , 2668 , 2669 , 2670 , 2671 , 2672 , 2673 , 2674 , 2675 , 2676 , 2802 , 2677 , 2678 , 2679 , 2680 , 2681 , 2682 , 2683 , 2684 , 2685 , 2686 , 2687 , 2688 , 2689 , 2691 , 2692 , 2693 , 2694 , 2695 , 2696 , 377 , 2111 , 1698 , 1146 , 903 , 1699 , 1496 , 2112 , 1700 , 2219 , 378 , 621 , 622 , 257 , 1540 , 905 , 906 , 907 , 908 , 909 , 910 , 1701 , 1001 , 1917 , 2769 , 623 , 258 , 259 , 260 , 624 , 625 , 626 , 627 , 628 , 2113 , 2114 , 2800 , 2115 , 629 , 630 , 631 , 632 , 2116 , 1541 , 1704 , 1705 , 1002 , 634 , 1542 , 635 , 2756 , 1707 , 2117 , 2118 , 2119 , 1711 , 2270 , 2271 , 636 , 1918 , 637 , 1003 , 1920 , 638 , 2120 , 2121 , 640 , 641 , 642 , 1712 , 643 , 644 , 645 , 646 , 647 , 648 , 649 , 1004 , 650 , 1497 , 1921 , 651 , 1543 , 262 , 911 , 261 , 1715 , 263 , 1006 , 1544 , 2762 , 1922 , 652 , 1498 , 653 , 1717 , 2131 , 1718 , 654 , 1719 , 1007 , 1008 , 1545 , 1924 , 1720 , 349 , 655 , 2793 , 1147 , 1722 , 1925 , 1926 , 1927 , 1148 , 1928 , 1149 , 1077 , 1725 , 1929 , 2125 , 2126 , 2127 , 1383 , 1387 , 1930 , 658 , 2128 , 2129 , 1546 , 1547 , 1548 , 264 , 265 , 266 , 267 , 1726 , 1499 , 1993 , 1150 , 350 , 2028 , 2029 , 2030 , 1727 , 1729 , 1009 , 2130 , 1730 , 1731 , 1732 , 660 , 661 , 1010 , 662 , 1385 , 379 , 1733 , 1734 , 1078 , 1735 , 1011 , 1931 , 2132 , 2133 , 2134 , 1932 , 2745 , 2183 , 1500 , 1933 , 1934 , 1738 , 2135 , 1012 , 1741 , 2136 , 2137 , 664 , 1151 , 1152 , 1153 , 1154 , 1155 , 380 , 1388 , 1743 , 1745 , 1746 , 2819 , 1748 , 2813 , 666 , 667 , 2138 , 668 , 2031 , 2139 , 1013 , 2757 , 669 , 1014 , 2221 , 1749 , 2032 , 1156 , 1501 , 1015 , 1935 , 1936 , 671 , 1502 , 1503 , 1504 , 672 , 2222 , 1751 , 1752 , 2141 , 2142 , 2143 , 268 , 1937 , 912 , 673 , 1754 , 2144 , 2272 , 351 , 1938 , 674 , 459 , 2145 , 2146 , 1016 , 1755 , 1757 , 1759 , 1762 , 1763 , 1764 , 1766 , 1767 , 1768 , 1770 , 1771 , 675 , 2790 , 676 , 1080 , 677 , 269 , 1017 , 2224 , 1081 , 678 , 679 , 680 , 681 , 1018 , 1157 , 1083 , 1084 , 1939 , 270 , 1940 , 682 , 1505 , 1506 , 271 , 683 , 684 , 1941 , 1942 , 352 , 2147 , 1507 , 2037 , 2033 , 2034 , 2035 , 2038 , 2039 , 2040 , 2226 , 2041 , 2042 , 2043 , 2044 , 2045 , 1775 , 1019 , 1389 , 1390 , 1391 , 1020 , 2148 , 272 , 273 , 274 , 275 , 1021 , 685 , 2149 , 1 , 1943 , 1158 , 1777 , 2227 , 2228 , 686 , 2150 , 688 , 687 , 1023 , 381 , 1778 , 1779 , 2152 , 1393 , 1392 , 1394 , 913 , 914 , 1395 , 1944 , 1508 , 1945 , 1509 , 2154 , 1781 , 1782 , 2155 , 2809 , 691 , 692 , 693 , 694 , 1946 , 1947 , 1948 , 1949 , 2229 , 695 , 320 , 2046 , 2233 , 2230 , 2231 , 2232 , 2234 , 2235 , 2236 , 2048 , 696 , 2049 , 1950 , 915 , 2156 , 1398 , 1399 , 2770 , 2237 , 1783 , 2157 , 698 , 1951 , 382 , 353 , 916 , 1549 , 2238 , 2239 , 383 , 699 , 700 , 1400 , 1085 , 2798 , 2810 , 1086 , 1784 , 1785 , 1787 , 1788 , 2051 , 701 , 321 , 322 , 323 , 2710 , 702 , 2240 , 703 , 704 , 705 , 1510 , 1401 , 1402 , 706 , 1087 , 707 , 1404 , 1403 , 1405 , 1952 , 1789 , 354 , 1953 , 324 , 325 , 326 , 1024 , 708 , 2242 , 2241 , 709 , 710 , 1790 , 2159 , 711 , 384 , 1025 , 1026 , 1954 , 1028 , 1029 , 1030 , 1955 , 1031 , 1032 , 1956 , 2243 , 460 , 461 , 462 , 463 , 1512 , 1513 , 2160 , 1033 , 1034 , 918 , 1791 , 1035 , 327 , 2702 , 714 , 919 , 385 , 1792 , 2161 , 1088 , 715 , 328 , 2162 , 2163 , 1793 , 1550 , 1514 , 2244 , 2245 , 716 , 717 , 718 , 1796 , 2184 , 2246 , 2247 , 1406 , 1407 , 1797 , 1798 , 1799 , 2248 , 2249 , 2250 , 2251 , 1800 , 464 , 2765 , 1802 , 2746 , 719 , 2164 , 1805 , 1995 , 2252 , 721 , 1957 , 1807 , 1808 , 1809 , 1810 , 1958 , 921 , 920 , 1408 , 1409 , 2715 , 2717 , 2718 , 2716 , 2713 , 2714 , 1811 , 922 , 923 , 924 , 1037 , 1959 , 1960 , 1961 , 1962 , 1089 , 1038 , 1039 , 2165 , 2166 , 2167 , 722 , 1159 , 1551 , 1410 , 1411 , 1412 , 723 , 724 , 726 , 727 , 729 , 730 , 1552 , 731 , 1963 , 386 , 925 , 2253 , 2254 , 1964 , 1965 , 1966 , 1090 , 2748 , 2736 , 1967 , 1813 , 1814 , 465 , 1816 , 732 , 1994 , 1817 , 733 , 1818 , 1819 , 1820 , 734 , 1821 , 1822 , 926 , 735 , 1823 , 1515 , 927 , 736 , 737 , 2804 , 738 , 739 , 740 , 741 , 742 , 743 , 1968 , 2168 , 928 , 1969 , 1824 , 1825 , 1826 , 1091 , 744 , 1553 , 1040 , 2273 , 745 , 2170 , 746 , 1827 , 1092 , 1093 , 1094 , 1516 , 329 , 747 , 1095 , 748 , 1414 , 1517 , 1518 , 1415 , 2185 , 2053 , 1829 , 749 , 1830 , 1831 , 1041 , 1832 , 466 , 387 , 330 , 929 , 2171 , 1971 , 1979 , 1980 , 1983 , 1975 , 1976 , 1972 , 1973 , 1977 , 1978 , 1981 , 1982 , 1984 , 1970 , 1974 , 1416 , 1417 , 1418 , 1419 , 388 , 930 , 2697 , 931 , 1420 , 1160 , 331 , 1985 , 932 , 2698 , 2699 , 933 , 1519 , 1520 , 751 , 1421 , 2054 , 2055 , 753 , 2172 , 1424 , 1425 , 1426 , 1427 , 1428 , 1429 , 1430 , 1835 , 1836 , 1096 , 1097 , 332 , 333 , 754 , 2743 , 1521 , 1522 , 1523 , 1524 , 2761 , 1837 , 757 , 2709 , 759 , 760 , 762 , 763 , 764 , 765 , 767 , 768 , 1838 , 769 , 2274 , 2173 , 2174 , 2175 , 2176 , 2177 , 934 , 1525 , 1986 , 1161 , 2056 , 1987 , 1431 , 2057 , 770 , 771 , 773 , 1555 , 1556 , 1557 , 1558 , 772 , 2275 , 1526 , 774 , 935 , 936 , 389 , 775 , 1527 , 1528 , 1529 , 1530 , 390 , 391 , 1840 , 2255 , 2256 , 1432 , 1098 , 1099 , 1988 , 2791 , 1162 , 1842 , 2178 , 2179 , 2773 , 937 , 938 , 939 , 1989 , 1042 , 1043 , 777 , 1843 , 2059 , 778 , 334 , 779 , 781 , 395 , 392 , 393 , 394 , 396 , 397 , 398 , 399 , 401 , 402 , 403 , 404 , 405 , 406 , 400 )        inner join st_subcategorymaster SM  ON IM.SubCategoryID = SM.SubCategoryID   and IM.subcategorytypeid in ( 2 , 3 , 5 , 6 , 7 , 8 , 9 , 10 , 11 , 12 , 13 , 14 , 15 , 16 , 17 , 18 , 19 , 20 , 21 , 22 ) inner join st_categorytypemaster cat on cat.categorytypeid=im.categorytypeid   INNER JOIN st_subcategorytypemaster subcat ON subcat.SubCategoryTypeID=im.SubCategoryTypeID    INNER JOIN st_subcategorymaster itemcat ON itemcat.SubCategoryID=im.SubCategoryID            GROUP BY Temp5.ItemID            having ( OpenQty > 0 or  PurchaseQty > 0 or  `AdjustmentQty(+)` > 0 or  IssueQty > 0 or  IssueReturnQty > 0 or  VendorReturnQty > 0 or  `ProcessQty(-)` > 0 or  GatherQty > 0 or LocationReceiveQty > 0  )           ORDER BY  CategoryTypeName,SubCategoryTypeName,itemTypeName,ItemName,ManufactureName,MachineName,packsize   