 SELECT salesno TransactionNo,Location ConsumeLocation,stm.State,cat.CategoryTypeName,subcat.SubCategoryTypeName,itemcat.Name itemgroupName,  stn.itemid,stn.itemname,stn.barcodeno,sm.MachineName,sum(snd.Quantity) ConsumeQuantity,SUM(stn.Unitprice*snd.Quantity) ConsumeAmount ,stn.minorunit ConsumeUnit,DATE_FORMAT(stn.`ExpiryDate`,%d-%b-%Y) ExpiryDate,stn.BatchNumber   FROM `st_nmsalesdetails` snd  INNER JOIN `st_locationmaster` slm ON snd.fromlocationid=slm.locationid  and slm.locationID in (10,17)  and slm.locationid IN (26,33,30,28,29,31,32,27,34,25,35,22,24,23,36) INNER JOIN state_master stm ON stm.`id`=slm.`StateID`  INNER JOIN st_nmstock stn ON stn.stockid=snd.stockid  AND (`InitialCount` - `ReleasedCount` - `PendingQty`) > 0  INNER JOIN st_itemmaster sm ON sm.itemid=stn.itemid  INNER JOIN st_categorytypemaster cat ON cat.CategoryTypeID=sm.CategoryTypeID   INNER JOIN st_subcategorytypemaster subcat ON subcat.SubCategoryTypeID=sm.SubCategoryTypeID   INNER JOIN st_subcategorymaster itemcat ON itemcat.SubCategoryID=sm.SubCategoryID    AND snd.DATETIME>=2022-03-01 00:00:00 AND snd.DATETIME<=2022-04-02 23:59:59  GROUP BY snd.fromlocationid,sm.itemid 