 SELECT salesno TransactionNo,snd.IndentNo,slm.Location FromLocation,sm12.state FromLocationState,slm1.location ToLocation ,sm121.state ToLocationState,cat.CategoryTypeName,subcat.SubCategoryTypeName,itemcat.Name itemgroupName,  sm.typename itemname,sm.HsnCode,stn.barcodeno,sm.MachineName,sm.ManufactureName,sm.packsize ,DATE_FORMAT(stn.`ExpiryDate`,'%d-%b-%Y')ExpiryDate,stn.BatchNumber, (SELECT group_concat(DISTINCT issueinvoiceno) FROM st_indentissuedetail WHERE stockid=snd.stockid and indentno=snd.indentno)Issueinvoiceno, snd.Quantity ReceiveQuantity , (stn.rate*snd.Quantity)Rate,ROUND((stn.DiscountAmount*snd.Quantity),2) DiscountAmt,stn.taxper, (stn.unitprice*snd.Quantity) ReceiveAmt,stn.minorunit ReceiveUnit,  (stn.taxamount*snd.Quantity) TaxAmount,  if(sm12.state=sm121.state,0,(stn.taxamount*snd.Quantity)) TaxAmtIGST,  if(sm12.state<>sm121.state,0,(stn.taxamount*snd.Quantity)/2) TaxAmtCGST,  if(sm12.state<>sm121.state,0,(stn.taxamount*snd.Quantity)/2)  TaxAmtSGST, snd.IssueType, DATE_FORMAT(DATETIME,'%b-%Y') ReceiveMonth,  DATE_FORMAT(DATETIME,'%d-%b-%Y') ReceiveDate,snd.Naration Remarks,(SELECT NAME FROM employee_master WHERE employee_id=snd.UserID) UserName   FROM `st_nmsalesdetails` snd  INNER JOIN `st_locationmaster` slm ON snd.fromlocationid=slm.locationid  and slm.locationid in (22) INNER JOIN st_locationmaster slm1 ON slm1.locationid=snd.tolocationid   inner join state_master sm12 on   sm12.id=slm.StateID   inner join state_master sm121 on   sm121.id=slm1.StateID  INNER JOIN st_nmstock stn ON stn.stockid=snd.stockid  INNER JOIN st_itemmaster sm ON sm.itemid=stn.itemid  and sm.itemid in (2434) and sm.MachineID in (9) INNER JOIN st_categorytypemaster cat ON cat.CategoryTypeID=sm.CategoryTypeID   and cat.CategoryTypeID in (2) INNER JOIN st_subcategorytypemaster subcat ON subcat.SubCategoryTypeID=sm.SubCategoryTypeID   and subcat.SubCategoryTypeID in (2,3,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22) INNER JOIN st_subcategorymaster itemcat ON itemcat.SubCategoryID=sm.SubCategoryID    and itemcat.SubCategoryTypeID in (2,3,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22) WHERE TrasactionTypeID=2   AND snd.DATETIME>='2022-04-01 00:00:00' AND snd.DATETIME<='2022-04-16 23:59:59' 