    SELECT * FROM (SELECT                  t.*,      (SELECT CASE WHEN IsPackage='1' AND PrintInterPackage='1' THEN     Interpretation WHEN isPackage='0' AND PrintInterTest='1' THEN Interpretation ELSE '' END     FROM investigation_master_interpretation WHERE `Investigation_ID`=im.`Investigation_ID` AND     centreid=t.centreid AND macid=IF(t.MachineID='0','1',t.MachineID) LIMIT 1 ) AS Interpretation            ,'3' ReportType,CONCAT(IF(t.IsPackage=1,'',''),               IF(IM.PrintSampleName=0,IF(IFNULL(itm.Inv_ShortName,'')!='',IM.Name,IM.Name),im.name)) AS TestName,im.method,im.FileLimitationName, scm.deptinterpretaion,                 otm.Name AS Dept,otm.isVisible AS DeptVisible,                IM.Print_sequence AS Print_Sequence_Investigation,                     im.PrintSeparate,im.printsamplename,              IM.Description AS d1,t.labPriorty Priorty,IF(VALUE ='HEAD' ,'Y','N') IsParent,im.printHeader  AS invHeader ,              '' SampleTypeID,cma.Centre CentreName,cma.Address,cma.Landline CentreLandline,cma.Mobile CentreMobile,cma.Email              CentreEmail,cma.NablLogoPath,cma.CapLogoPath,'' printOrder , cma.type1, cmat.Centre TestCentreName ,cmat.Address TestCentreAddress,             IFNULL((SELECT isNABL FROM `investiagtion_isnabl` WHERE Investigation_ID=im.Investigation_Id AND centreid=t.CentreID),0)isNABL,              otm.Print_Sequence Print_Sequence_Dept,IFNULL(t.labPriorty,9999)printOrder_labObservation1,labPriorty printOrder_labObservation2               ,otm.ObservationType_ID,pnl.`Panel_Code`,pnl.ShowSignature,IFNULL(LEFT(pnl.Add1,30),'')ClientAddress,    pnl.ReportHeaderHeight,pnl.ReportHeaderXPosition,pnl.ReportHeaderYPosition,pnl.ReportFooterHeight,pnl.ReportBackGroundImage,pnl.AAALogo,pnl.TagProcessingLabID,pnl.mobile Company_no,upper(left(pnl.area,10)) Company_add             FROM (                   SELECT   pm.Mobile,pm.House_No paddress,loi.ParentId, pli.laboutsrcid,            pli.LedgerTransactionNo AS LabNo,pli.test_id PLOID,pli.test_id,IF(lt.HomeVisitBoyID='N/A','N/A',(SELECT  flm.NAME FROM feildboy_master flm WHERE flm.FeildBoyID=lt.HomeVisitBoyID)) FieldExe,             lt.PName,lt.Age,pli.BarcodeNo,LEFT(lt.Gender,1)Gender,mic.reporttype ReportStatus,IF(pli.Approved=0,'Provisional Report','Final Report')ReportStatus1,lt.OtherReferLab,lt.Interface_companyName,lt.CorporateIDCard,lt.LedgerTransactionNo_Interface,             DATE_FORMAT(pli.date,'%d/%b/%Y %I:%i') DateEnrolled,lt.Patient_ID,'' Description,pli.SampleBySelf,              DATE_FORMAT(pli.ResultEnteredDate,'%d-%b-%y')AS ResultDate, pli.ResultEnteredBy,pli.ForwardBy,         mic.labobservation_id, labobservation_name ,VALUE, unit,labobservationcomment,      OrganismID,OrganismName, OrganismGroupID, OrganismGroupName,EnzymeId, Enzymename, Enzymevalue,      EnzymeUnit,Antibioticid, AntibioticName, AntibioticGroupid, AntibioticGroupname,     IF(AntibioticInterpreatation='Intermediate' || AntibioticInterpreatation='Sensitive' ,    CONCAT('<b>',AntibioticInterpreatation,'<b>'), AntibioticInterpreatation)AntibioticInterpreatation,  MIC, IF(MIC='','',BreakPoint)BreakPoint,      MIC_BP, mic.Reporttype  MicroReporType          ,pli.Investigation_ID, pli.SlideNumber,pli.TestCentreID,                  DATE_FORMAT(pli.SampleCollectionDate,'%d/%b/%Y %I:%i')SampleDate,              DATE_FORMAT(pli.SampleReceiveDate,'%d/%b/%Y  %I:%i')ReceiveDate,              DATE_FORMAT(pli.Date,'%d-%b-%y %h:%i')DATE,                    IF(pli.Approved=1,1,0)Approved,(SELECT comments FROM patient_labinvestigation_opd_comments ploc WHERE ploc.Test_ID = pli.Test_ID)comments,                IF(pli.isHold=1,'Hold',                IF(pli.Approved=1,'Approved',IF(pli.isForward=1,'Forward',''))) AS MYApproved,               IF(pli.isHold=1,pli.HoldByName,IF(pli.Approved=1,'',IF(pli.isForward=1,pli.ForwardByName,'')))                AS MYApprovedBy,       DATE_FORMAT(pli.Approveddate,'%d/%b/%Y %I:%i%p')ApprovedDate,               (SELECT EmployeeID FROM f_approval_labemployee WHERE technicalID=pli.ApprovedBy AND (Approval=4 OR approval=3) LIMIT 1) ApprovedBy,(SELECT  CONCAT(Title, pli.`ApprovedName`) FROM  `employee_master`  WHERE  Employee_ID=pli.`ApprovedBy`)ApprovedName, DATE_FORMAT(mic.ResultEntrydateTime,'%d/%b/%Y %I:%i%p')ResultEnteredDate,            (SELECT  CONCAT(Title, pli.`ResultEnteredName`) FROM  `employee_master`  WHERE  Employee_ID=pli.`ResultEnteredBy`)ResultEnteredName , 0 Child_Flag,               loi.printOrder  labPriorty,'' DisplayReading,IF(pli.IsPackage=1,pli.PackageName,'') PackageName, pli.IsPackage,               '' DispatchMode                    ,'' ObsInterpretation ,              '' MethodName,DATE_FORMAT(pli.sampleCollectiondate,'%d/%b/%Y %I:%i')SegratedDate,DATE_FORMAT(NOW(),'%d/%b/%Y %I:%i')PrintDate,'0' IsCommentField ,'0' IsOrganism,'' AbnormalValue,'' IsBold,'' IsUnderLine,'' `IsMic`,             '' SepratePrint,               1 isborder,0 MachineID  , lt.centreid,lt.Panel_ID,IF(lt.`DoctorName`='SELF',lt.`DoctorName`,CONCAT('Dr.', lt.`DoctorName`))ReferDoctor, IF(lt.OtherReferLab='',CONCAT(SUBSTRING(lt.panelname,1,33),'.'),lt.OtherReferLab) Company_Name ,'' Company_code,'' Company_add1,lt.`HLMPatientType`,lt.`HLMOPDIPDNo`,pli.SampleTypeName,IFNULL(lt.PatientType,'')PatientType              FROM patient_labobservation_opd_mic mic                  INNER JOIN patient_labinvestigation_opd pli ON pli.Test_ID = mic.TestID and mic.labobservation_id<>''                AND pli.Test_ID IN ({0})  AND pli.Result_Flag = 1 AND pli.ishold=0   and mic.reporttype='Preliminary'              INNER JOIN f_ledgertransaction lt ON lt.LedgerTransactionID=pli.LedgerTransactionID               INNER JOIN patient_master pm ON pm.patient_id=lt.patient_id                             LEFT JOIN `labobservation_investigation` loi ON loi.`Investigation_Id`=pli.`Investigation_ID` AND loi.`labObservation_ID`=mic.`labobservation_id`               )t                   INNER JOIN investigation_master IM ON IM.Investigation_Id = t.Investigation_ID                INNER JOIN f_itemmaster itm ON itm.Type_ID = IM.Investigation_ID                  INNER JOIN `f_subcategorymaster` scm ON scm.`SubCategoryID`=itm.`SubCategoryID` AND scm.`CategoryID`='LSHHI3'                INNER JOIN investigation_observationtype iot ON iot.Investigation_ID=im.Investigation_Id                INNER JOIN observationtype_master otm ON otm.ObservationType_ID=iot.ObservationType_Id                 INNER JOIN centre_master cma ON cma.CentreID = t.CentreId      inner JOIN centre_master cmat ON cmat.CentreID = t.TestCentreID              INNER JOIN f_panel_master pnl ON pnl.`Panel_ID`=t.Panel_ID                 ORDER BY test_id,LabNo,IFNULL(printOrder,9999),labPriorty   )ttt   