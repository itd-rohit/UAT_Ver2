   SELECT (SELECT location FROM st_locationmaster WHERE locationid=pom.locationid)DeliveryLocation,     DATE_FORMAT(pom.CreatedDate,'%d-%b-%Y')PODate,IFNULL(CreatedByName,'') POCreatedBY,    pom.PurchaseOrderNo,VendorName,    IFNULL(IndentNo,'')PIIndentNo,    sum( Rate*(IF(ApprovedQty=0,IF(CheckedQty=0,OrderedQty,CheckedQty),ApprovedQty))) GrossTotal,   sum( DiscountAmount*(IF(ApprovedQty=0,IF(CheckedQty=0,OrderedQty,CheckedQty),ApprovedQty))) TotalDiscount,   sum( pod.TaxAmount*(IF(ApprovedQty=0,IF(CheckedQty=0,OrderedQty,CheckedQty),ApprovedQty))) Totaltax,  sum( UnitPrice*(IF(ApprovedQty=0,IF(CheckedQty=0,OrderedQty,CheckedQty),ApprovedQty)) ) NetTotal     ,IF(IsDirectPO=0,'PO From PI','Direct PO') POType ,    DATE_FORMAT(pom.CheckedDate,'%d-%b-%Y')CheckedDate, CheckedByName,    DATE_FORMAT(pom.ApprovedDate,'%d-%b-%Y')ApprovedDate,  AppprovedByName    FROM `st_purchaseorder` pom    INNER JOIN st_purchaseorder_details pod ON pod.PurchaseOrderID=pom.PurchaseOrderID    AND pod.`IsActive`=1    AND pom.IsDirectPO='1'   where pom.`CreatedDate`>='2022-04-01 00:00:00'   AND pom.`CreatedDate`<='2022-04-13 23:59:59'     group by pom.PurchaseOrderID ORDER BY DeliveryLocation,CreatedDate